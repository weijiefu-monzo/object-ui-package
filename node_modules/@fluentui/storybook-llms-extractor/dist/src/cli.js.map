{"version":3,"sources":["../../src/cli.ts"],"sourcesContent":["import { join } from 'node:path';\nimport { cwd } from 'node:process';\nimport yargs from 'yargs';\n\nimport type { Args, StorybookRef } from './types';\nimport { extractStorybookData, writeSummaryFile, writeFullDocsFiles } from './utils';\n\nmain().catch(reason => {\n  console.error(reason);\n  process.exit(1);\n});\n\nasync function main() {\n  console.log(`━━ Storybook LLM Docs Generator ━━`);\n\n  const args = await processArgs();\n\n  console.log(`ℹ️ Storybook dist path: ${args.distPath}`);\n\n  const data = await extractStorybookData(args);\n\n  // Write summary/llms.txt file\n  await writeSummaryFile(args, data);\n\n  // Write per component/page files\n  await writeFullDocsFiles(args, data);\n\n  console.log(`✅ LLMs docs generation complete.`);\n  console.log(`ℹ️ You can find the generated files in the Storybook dist folder: ${args.distPath}`);\n}\n\n/**\n * Type guard for StorybookRef\n */\nfunction isStorybookRef(obj: unknown): obj is StorybookRef {\n  return (\n    !!obj &&\n    typeof obj === 'object' &&\n    'title' in obj &&\n    typeof obj.title === 'string' &&\n    'url' in obj &&\n    typeof obj.url === 'string'\n  );\n}\n\n/**\n * Parses refs from CLI arguments.\n */\nfunction parseRefs(refs: unknown[]): StorybookRef[] {\n  if (Array.isArray(refs)) {\n    return refs\n      .map(ref => {\n        if (typeof ref === 'string') {\n          try {\n            return JSON.parse(ref);\n          } catch {\n            return null;\n          }\n        }\n        return ref;\n      })\n      .filter(isStorybookRef);\n  }\n\n  return [];\n}\n\n/**\n * Processes CLI arguments for `distPath`, `refs`, and other options.\n *\n * Users are encouraged to provide a yargs-compatible config file (e.g., llms.config.js)\n * that exports all needed options, including a normalized refs array if desired.\n */\nasync function processArgs(): Promise<Required<Args>> {\n  const argv = await yargs(process.argv)\n    .usage('CLI to generate LLMs docs for Storybook docs')\n    .option('distPath', {\n      type: 'string',\n      demandOption: true,\n      describe: 'Relative path to the Storybook distribution folder',\n    })\n    .option('summaryBaseUrl', {\n      type: 'string',\n      default: '/',\n      describe: 'Base URL for the Storybook docs',\n    })\n    .option('summaryTitle', {\n      type: 'string',\n      default: 'Summary',\n      describe: 'Title for the summary file',\n    })\n    .option('summaryDescription', {\n      type: 'string',\n      default: '',\n      describe: 'Description for the summary file',\n    })\n    .option('refs', {\n      type: 'array',\n      default: [] as StorybookRef[],\n      describe: 'Array of composed Storybook refs (objects with id, title, url)',\n    })\n    .config()\n    .alias('h', 'help')\n    .version(false).argv;\n\n  return {\n    ...argv,\n    distPath: join(cwd(), argv.distPath),\n    refs: parseRefs(argv.refs),\n  };\n}\n"],"names":["main","catch","reason","console","error","process","exit","log","args","processArgs","distPath","data","extractStorybookData","writeSummaryFile","writeFullDocsFiles","isStorybookRef","obj","title","url","parseRefs","refs","Array","isArray","map","ref","JSON","parse","filter","argv","yargs","usage","option","type","demandOption","describe","default","config","alias","version","join","cwd"],"mappings":";;;;;0BAAqB;6BACD;gEACF;uBAGyD;AAE3EA,OAAOC,KAAK,CAACC,CAAAA;IACXC,QAAQC,KAAK,CAACF;IACdG,QAAQC,IAAI,CAAC;AACf;AAEA,eAAeN;IACbG,QAAQI,GAAG,CAAC,CAAC,kCAAkC,CAAC;IAEhD,MAAMC,OAAO,MAAMC;IAEnBN,QAAQI,GAAG,CAAC,CAAC,wBAAwB,EAAEC,KAAKE,QAAQ,EAAE;IAEtD,MAAMC,OAAO,MAAMC,IAAAA,2BAAoB,EAACJ;IAExC,8BAA8B;IAC9B,MAAMK,IAAAA,uBAAgB,EAACL,MAAMG;IAE7B,iCAAiC;IACjC,MAAMG,IAAAA,yBAAkB,EAACN,MAAMG;IAE/BR,QAAQI,GAAG,CAAC,CAAC,gCAAgC,CAAC;IAC9CJ,QAAQI,GAAG,CAAC,CAAC,kEAAkE,EAAEC,KAAKE,QAAQ,EAAE;AAClG;AAEA;;CAEC,GACD,SAASK,eAAeC,GAAY;IAClC,OACE,CAAC,CAACA,OACF,OAAOA,QAAQ,YACf,WAAWA,OACX,OAAOA,IAAIC,KAAK,KAAK,YACrB,SAASD,OACT,OAAOA,IAAIE,GAAG,KAAK;AAEvB;AAEA;;CAEC,GACD,SAASC,UAAUC,IAAe;IAChC,IAAIC,MAAMC,OAAO,CAACF,OAAO;QACvB,OAAOA,KACJG,GAAG,CAACC,CAAAA;YACH,IAAI,OAAOA,QAAQ,UAAU;gBAC3B,IAAI;oBACF,OAAOC,KAAKC,KAAK,CAACF;gBACpB,EAAE,OAAM;oBACN,OAAO;gBACT;YACF;YACA,OAAOA;QACT,GACCG,MAAM,CAACZ;IACZ;IAEA,OAAO,EAAE;AACX;AAEA;;;;;CAKC,GACD,eAAeN;IACb,MAAMmB,OAAO,MAAMC,IAAAA,cAAK,EAACxB,QAAQuB,IAAI,EAClCE,KAAK,CAAC,gDACNC,MAAM,CAAC,YAAY;QAClBC,MAAM;QACNC,cAAc;QACdC,UAAU;IACZ,GACCH,MAAM,CAAC,kBAAkB;QACxBC,MAAM;QACNG,SAAS;QACTD,UAAU;IACZ,GACCH,MAAM,CAAC,gBAAgB;QACtBC,MAAM;QACNG,SAAS;QACTD,UAAU;IACZ,GACCH,MAAM,CAAC,sBAAsB;QAC5BC,MAAM;QACNG,SAAS;QACTD,UAAU;IACZ,GACCH,MAAM,CAAC,QAAQ;QACdC,MAAM;QACNG,SAAS,EAAE;QACXD,UAAU;IACZ,GACCE,MAAM,GACNC,KAAK,CAAC,KAAK,QACXC,OAAO,CAAC,OAAOV,IAAI;IAEtB,OAAO;QACL,GAAGA,IAAI;QACPlB,UAAU6B,IAAAA,cAAI,EAACC,IAAAA,gBAAG,KAAIZ,KAAKlB,QAAQ;QACnCU,MAAMD,UAAUS,KAAKR,IAAI;IAC3B;AACF"}